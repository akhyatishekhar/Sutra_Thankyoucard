<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Sutra - Thank You Card Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Poppins:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,600;1,600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f3f4f6;
        }
        .card-container {
            width: 210mm; /* A4 Width */
            min-height: 297mm; /* A4 Height */
            background: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin: 0 auto;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        /* Theme: Standard/Event Header */
        .header-curve {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 350px;
            background: linear-gradient(135deg, #fff0f3 0%, #ffe4e6 100%);
            border-bottom-left-radius: 50% 20%;
            border-bottom-right-radius: 50% 20%;
            z-index: 0;
        }
        
        /* Theme: Elegant Header */
        .header-elegant {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: #1e3a8a; /* Dark Blue */
            z-index: 0;
        }
        .border-elegant {
            border: 2px solid #1e3a8a;
            margin: 20px;
            height: calc(100% - 40px);
            position: absolute;
            width: calc(100% - 40px);
            pointer-events: none;
            z-index: 5;
        }

        .heart-icon {
            color: #ef4444;
            filter: drop-shadow(0 4px 3px rgb(0 0 0 / 0.07));
        }
        .sutra-font {
            font-family: 'Nunito', sans-serif;
        }
        .playfair {
            font-family: 'Playfair Display', serif;
        }
        
        /* Specific Styles for "Event Highlight" Theme */
        .name-sticker {
            background: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-radius: 12px;
            padding: 8px 24px;
            display: inline-block;
            transform: rotate(-1deg);
        }
        .event-badge {
            background-color: #f97316; /* Orange-500 */
            color: white;
            border-radius: 16px;
            padding: 12px 24px;
            box-shadow: 0 4px 6px rgba(249, 115, 22, 0.3);
        }

        /* Print Styles */
        @media print {
            body * {
                visibility: hidden;
            }
            #card-preview, #card-preview * {
                visibility: visible;
            }
            #card-preview {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                margin: 0;
                box-shadow: none;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .no-print {
                display: none;
            }
        }
        
        /* Loading Overlay */
        #loadingOverlay {
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-center;
            z-index: 50;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto flex flex-col lg:flex-row gap-8">
        
        <!-- Controls Section -->
        <div class="w-full lg:w-1/3 no-print">
            <div class="bg-white p-6 rounded-xl shadow-lg sticky top-8 max-h-[90vh] overflow-y-auto">
                <h1 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-2">Card Generator</h1>
                
                <div class="space-y-6">
                    <!-- Design Selection -->
                    <div class="bg-indigo-50 p-4 rounded-lg border border-indigo-100">
                        <label class="block text-sm font-bold text-indigo-900 mb-2">1. Choose Design Theme</label>
                        <select id="themeSelector" class="w-full border-indigo-200 rounded-lg shadow-sm focus:border-indigo-500 focus:ring-indigo-500 border p-2 text-indigo-900 bg-white">
                            <option value="event">Theme A: Event Highlight (New)</option>
                            <option value="message">Theme B: Heartfelt Message (Original)</option>
                            <option value="elegant">Theme C: Elegant Formal</option>
                        </select>
                    </div>

                    <!-- Recipient Details -->
                    <div>
                        <h3 class="text-sm font-bold text-gray-900 mb-3 uppercase tracking-wider text-xs">Recipient Info</h3>
                        <div class="grid grid-cols-3 gap-3 mb-3">
                            <div class="col-span-1">
                                <label class="block text-xs font-medium text-gray-600 mb-1">Title</label>
                                <select id="titleInput" class="w-full border-gray-300 rounded-md shadow-sm border p-2 text-sm">
                                    <option value="">(None)</option>
                                    <option value="Mr.">Mr.</option>
                                    <option value="Mrs.">Mrs.</option>
                                    <option value="Ms." selected>Ms.</option>
                                    <option value="Dr.">Dr.</option>
                                </select>
                            </div>
                            <div class="col-span-2">
                                <label class="block text-xs font-medium text-gray-600 mb-1">Name</label>
                                <input type="text" id="nameInput" value="Khyati" class="w-full border-gray-300 rounded-md shadow-sm border p-2 text-sm">
                            </div>
                        </div>
                    </div>

                    <!-- Dynamic Fields (Event Info) -->
                    <div id="eventFields" class="space-y-3 transition-all">
                        <h3 class="text-sm font-bold text-gray-900 mb-1 uppercase tracking-wider text-xs border-t pt-3">Event Details</h3>
                        <div>
                            <label class="block text-xs font-medium text-gray-600 mb-1">Program Name</label>
                            <input type="text" id="programInput" value="SPECIAL LUNCH PROGRAM" class="w-full border-gray-300 rounded-md shadow-sm border p-2 text-sm uppercase">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-600 mb-1">Beneficiary Group</label>
                            <input type="text" id="beneficiaryInput" value="God's Special Children" class="w-full border-gray-300 rounded-md shadow-sm border p-2 text-sm">
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                             <div>
                                <label class="block text-xs font-medium text-gray-600 mb-1">Date</label>
                                <input type="text" id="dateInput" value="01.02.2024" class="w-full border-gray-300 rounded-md shadow-sm border p-2 text-sm">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-600 mb-1">Location</label>
                                <input type="text" id="locationInput" value="Pratibandhi Punarbashan Kendra" class="w-full border-gray-300 rounded-md shadow-sm border p-2 text-sm">
                            </div>
                        </div>
                    </div>

                    <!-- Logo Upload -->
                    <div>
                         <h3 class="text-sm font-bold text-gray-900 mb-2 uppercase tracking-wider text-xs border-t pt-3">Assets</h3>
                        <label class="block text-xs font-medium text-gray-600 mb-1">Logo Image</label>
                        <input type="file" id="logoUpload" accept="image/*" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-pink-50 file:text-pink-700 hover:file:bg-pink-100">
                        <p class="text-[10px] text-gray-500 mt-1">Default Sutra logo is loaded. Upload to override.</p>
                    </div>

                    <!-- Actions -->
                    <div class="pt-4 grid grid-cols-2 gap-3 border-t mt-4">
                        <button onclick="downloadImage()" class="bg-pink-600 text-white px-3 py-3 rounded-lg hover:bg-pink-700 transition shadow flex items-center justify-center gap-2 font-medium text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                            </svg>
                            Download Image
                        </button>
                        
                        <button onclick="window.print()" class="bg-gray-800 text-white px-3 py-3 rounded-lg hover:bg-black transition shadow flex items-center justify-center gap-2 font-medium text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                            </svg>
                            Save as PDF
                        </button>
                    </div>
                     <p id="statusMsg" class="text-xs text-center text-gray-500 mt-2 h-4"></p>
                </div>
            </div>
        </div>

        <!-- Preview Section -->
        <div class="w-full lg:w-2/3 flex justify-center bg-gray-200 p-4 lg:p-8 rounded-xl overflow-auto relative">
            
            <!-- Loading Indicator -->
            <div id="loadingOverlay" class="absolute inset-0 bg-white/50 z-50 hidden rounded-xl">
                 <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-pink-600"></div>
            </div>

            <!-- The Card -->
            <div id="card-preview" class="card-container text-center text-gray-800">
                
                <!-- Dynamic Background Elements -->
                <div id="bgLayer"></div>

                <!-- Content Wrapper -->
                <div class="relative z-10 flex flex-col h-full p-12">
                    
                    <!-- Dynamic Main Content -->
                    <div id="mainContent" class="flex-grow flex flex-col">
                        <!-- Content injected via JS -->
                    </div>

                    <!-- NGO Description (Static) -->
                    <div class="mt-8 px-10">
                        <p class="text-gray-500 font-medium text-sm leading-relaxed border-t border-gray-100 pt-6">
                            A Sutra is a voluntary and self-funding NGO registered as a<br>
                            Society, committed to the advancement of Urban, Tribal,<br>
                            and Rural communities.
                        </p>
                    </div>

                    <!-- Footer Section (Static) -->
                    <div class="mt-auto pt-8 flex flex-row items-end justify-between text-left">
                        
                        <!-- Logo & Details Left -->
                        <div class="flex gap-4 items-start w-2/3">
                            <!-- Logo Image Area -->
                            <div class="flex-shrink-0 w-32 h-32 flex items-center justify-center bg-white relative">
                                <!-- UPDATED: Default Logo Source -->
                                <img id="logoPreview" src="https://static.wixstatic.com/media/3062bf_fe6a06a571274d07a63f71d7543e5c22~mv2.png/v1/fill/w_112,h_112,al_c,q_85,usm_0.66_1.00_0.01,enc_avif,quality_auto/sutra_logo.png" crossorigin="anonymous" alt="Logo" class="max-w-full max-h-full object-contain">
                                <!-- Placeholder if no logo uploaded -->
                                <div id="logoPlaceholder" class="hidden text-center p-2 border-2 border-dashed border-gray-300 rounded bg-gray-50 w-full h-full flex flex-col items-center justify-center">
                                    <span class="text-xs text-gray-400">Upload Logo</span>
                                </div>
                            </div>

                            <!-- Text Details -->
                            <div class="text-[10px] text-gray-700 space-y-0.5 leading-tight">
                                <h3 class="text-2xl text-blue-800 font-bold mb-1 sutra-font">a sutra <span class="text-lg font-normal text-gray-600">‡§è‡§ï ‡§∏‡•Ç‡§§‡•ç‡§∞</span></h3>
                                <p class="font-bold text-blue-900">(A Societal for Urban, Tribal & Rural Advancement)</p>
                                <p>West Bengal Act. XXVI of 1961 : SO171363 of 2010-2011</p>
                                <p>NGO Darpan ID : WB/2022/0318362</p>
                                <p class="text-red-800 font-semibold">12A - 80G Application No. : AAMAA2508AE20241</p>
                                
                                <div class="pt-2 space-y-0.5 text-blue-900 font-medium">
                                    <p class="flex items-center gap-1">
                                        <span>üìû</span> 7864888797
                                    </p>
                                    <p class="flex items-center gap-1">
                                        <span>‚úâÔ∏è</span> sutra.ngo@gmail.com
                                    </p>
                                    <p class="flex items-center gap-1">
                                        <span>üåê</span> www.SutraNGO.com
                                    </p>
                                    <p class="flex items-start gap-1">
                                        <span>üìç</span> 
                                        <span>Malancha Road (Behind Petrol Pump)<br>Kharagpur-721304, Paschim Medinipur</span>
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- 15 Years Badge Right -->
                        <div class="flex flex-col items-end justify-end text-right">
                             <div class="relative">
                                <span class="text-5xl font-bold text-green-600 tracking-tighter block" style="text-shadow: 2px 2px 0px white;">15</span>
                                <span class="text-xl text-gray-500 font-bold -mt-2 block">years</span>
                             </div>
                             <p class="text-sm text-gray-500 font-medium mt-1">Doing our bit, since 2010</p>
                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // DOM Elements
        const themeSelector = document.getElementById('themeSelector');
        const inputs = {
            title: document.getElementById('titleInput'),
            name: document.getElementById('nameInput'),
            program: document.getElementById('programInput'),
            beneficiary: document.getElementById('beneficiaryInput'),
            date: document.getElementById('dateInput'),
            location: document.getElementById('locationInput'),
        };
        const eventFieldsContainer = document.getElementById('eventFields');
        const mainContent = document.getElementById('mainContent');
        const bgLayer = document.getElementById('bgLayer');
        const logoUpload = document.getElementById('logoUpload');
        const logoPreview = document.getElementById('logoPreview');
        const logoPlaceholder = document.getElementById('logoPlaceholder');
        const statusMsg = document.getElementById('statusMsg');
        const loadingOverlay = document.getElementById('loadingOverlay');

        // Render Functions
        function renderCard() {
            const theme = themeSelector.value;
            const data = {
                title: inputs.title.value,
                name: inputs.name.value || "Benefactor",
                program: inputs.program.value,
                beneficiary: inputs.beneficiary.value,
                date: inputs.date.value,
                location: inputs.location.value
            };

            // Toggle Field Visibility
            if (theme === 'event') {
                eventFieldsContainer.classList.remove('hidden');
            } else {
                eventFieldsContainer.classList.add('hidden');
            }

            // Update Background
            updateBackground(theme);

            // Generate HTML based on Theme
            let html = '';

            if (theme === 'event') {
                // THEME A: EVENT HIGHLIGHT (New)
                html = `
                    <div class="mt-8 mb-8">
                         <div class="flex justify-center mb-4">
                            <svg class="w-16 h-16 text-red-500 heart-icon" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                            </svg>
                        </div>
                        <h1 class="text-7xl font-bold tracking-wide text-red-500 opacity-90 sutra-font mb-8">THANK YOU</h1>
                        
                        <div class="mb-6">
                            <div class="name-sticker">
                                <span class="text-2xl font-bold text-gray-900">${data.title} ${data.name}</span>
                            </div>
                        </div>

                        <p class="text-2xl text-gray-700 font-medium mb-2">for your generous contribution.</p>
                        <p class="text-xl text-gray-500 italic mb-6">towards our</p>

                        <h2 class="text-4xl font-extrabold text-gray-800 uppercase tracking-tight mb-2">${data.program}</h2>
                        
                        <p class="text-2xl text-red-500 font-semibold mb-8">for ${data.beneficiary}</p>

                        <div class="flex justify-center">
                            <div class="event-badge">
                                <p class="text-lg font-medium">organized on ${data.date}, at<br><span class="font-bold">${data.location}</span></p>
                            </div>
                        </div>
                    </div>
                `;
            } else if (theme === 'message') {
                // THEME B: HEARTFELT (Original)
                html = `
                    <div class="mt-8 mb-12">
                        <div class="flex justify-center mb-6">
                            <svg class="w-16 h-16 text-red-500 heart-icon" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                            </svg>
                        </div>
                        <h1 class="text-7xl font-bold tracking-wide text-red-500 opacity-80 sutra-font">THANK YOU</h1>
                    </div>
                    <div class="flex-grow flex flex-col justify-center items-center space-y-8 px-8">
                        <p class="text-2xl leading-relaxed text-purple-900 font-medium">
                            Its such an overwhelming, thrilling &<br>
                            blessed feeling to have done this<br>
                            activity successfully.
                        </p>
                        <p class="text-2xl leading-relaxed text-purple-900 font-medium">
                            A big THANKS again to <br>
                            <span class="text-3xl font-bold text-purple-800 mt-2 block">
                                ${data.title} ${data.name}
                            </span>
                            <br>
                            for your generous contribution.
                        </p>
                    </div>
                `;
            } else if (theme === 'elegant') {
                // THEME C: ELEGANT (New Formal)
                html = `
                    <div class="mt-20 mb-12">
                         <h1 class="text-6xl font-bold tracking-widest text-blue-900 playfair mb-4">GRATITUDE</h1>
                         <div class="w-24 h-1 bg-yellow-500 mx-auto mb-10"></div>
                    </div>
                    
                    <div class="flex-grow flex flex-col items-center px-12">
                        <p class="text-xl text-gray-500 italic mb-6 playfair">This certificate of appreciation is presented to</p>
                        
                        <h2 class="text-4xl font-bold text-gray-900 mb-6 border-b-2 border-gray-200 pb-4 px-12">${data.title} ${data.name}</h2>
                        
                        <p class="text-lg text-gray-600 leading-loose">
                            In sincere recognition of your generous support and contribution towards<br>
                            <span class="font-bold text-blue-900">${data.program}</span>.
                        </p>
                        
                        <p class="mt-8 text-gray-600">Your kindness helps us build a better future.</p>
                    </div>
                `;
            }

            mainContent.innerHTML = html;
        }

        function updateBackground(theme) {
            let bgHTML = '';
            if (theme === 'elegant') {
                bgHTML = `<div class="header-elegant"></div><div class="border-elegant"></div>`;
            } else {
                bgHTML = `<div class="header-curve"></div>`;
            }
            bgLayer.innerHTML = bgHTML;
        }

        // Generate and Download Image
        async function downloadImage() {
            const card = document.getElementById('card-preview');
            statusMsg.textContent = "Generating image...";
            loadingOverlay.classList.remove('hidden');

            try {
                // Wait a moment for UI to update
                await new Promise(r => setTimeout(r, 100));

                const canvas = await html2canvas(card, {
                    scale: 2, // 2x scale for better resolution
                    useCORS: true, // Crucial for external logo
                    backgroundColor: '#ffffff',
                    logging: false
                });

                // Create download link
                const link = document.createElement('a');
                link.download = `ThankYou_${inputs.name.value.replace(/\s+/g, '')}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                statusMsg.textContent = "Download started!";
            } catch (err) {
                console.error(err);
                statusMsg.textContent = "Error. Try 'Save as PDF' instead.";
                alert("Could not generate image automatically (likely due to logo security). Please use 'Save as PDF'.");
            } finally {
                loadingOverlay.classList.add('hidden');
                setTimeout(() => statusMsg.textContent = "", 3000);
            }
        }

        // Event Listeners
        themeSelector.addEventListener('change', renderCard);
        Object.values(inputs).forEach(input => {
            input.addEventListener('input', renderCard);
        });

        // Handle Image Upload
        logoUpload.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    logoPreview.src = e.target.result;
                    logoPreview.classList.remove('hidden');
                    logoPlaceholder.classList.add('hidden');
                }
                reader.readAsDataURL(file);
            }
        });

        // Initial Render
        renderCard();

    </script>
</body>
</html>
